<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CDN API Dashboard</title>
    <link rel="stylesheet" href="/dashboard/static/css/dashboard.css">
    <link rel="icon" type="image/x-icon" href="/dashboard/static/favicon.ico">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <h1 class="dashboard-title">
                    <span class="title-icon">üöÄ</span>
                    CDN API Dashboard
                </h1>
                <div class="header-actions">
                    <button id="refresh-btn" class="btn btn-secondary">
                        <span class="btn-icon">üîÑ</span>
                        Refresh
                    </button>
                    <button id="settings-btn" class="btn btn-primary">
                        <span class="btn-icon">‚öôÔ∏è</span>
                        Settings
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Status Cards -->
            <section class="status-section">
                <div class="status-cards">
                    <div class="status-card" id="endpoints-card">
                        <div class="card-icon">üì°</div>
                        <div class="card-content">
                            <h3>API Endpoints</h3>
                            <div class="card-value" id="endpoints-count">-</div>
                            <div class="card-label">Discovered</div>
                        </div>
                    </div>
                    
                    <div class="status-card" id="categories-card">
                        <div class="card-icon">üìÇ</div>
                        <div class="card-content">
                            <h3>Categories</h3>
                            <div class="card-value" id="categories-count">-</div>
                            <div class="card-label">Available</div>
                        </div>
                    </div>
                    
                    <div class="status-card" id="health-card">
                        <div class="card-icon">üíö</div>
                        <div class="card-content">
                            <h3>System Health</h3>
                            <div class="card-value" id="health-status">-</div>
                            <div class="card-label">Status</div>
                        </div>
                    </div>
                    
                    <div class="status-card" id="uptime-card">
                        <div class="card-icon">‚è±Ô∏è</div>
                        <div class="card-content">
                            <h3>Uptime</h3>
                            <div class="card-value" id="uptime-value">-</div>
                            <div class="card-label">Hours</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- API Discovery Section -->
            <section class="discovery-section">
                <div class="section-header">
                    <h2>API Discovery</h2>
                    <div class="section-actions">
                        <label for="category-filter" class="visually-hidden">Filter by category</label>
                        <select id="category-filter" class="filter-select" aria-label="Filter endpoints by category">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                </div>
                
                <div class="discovery-content">
                    <div class="endpoints-grid" id="endpoints-grid">
                        <!-- Endpoints will be populated here -->
                    </div>
                </div>
            </section>

            <!-- API Testing Section -->
            <section class="testing-section">
                <div class="section-header">
                    <h2>API Testing</h2>
                    <button id="test-all-btn" class="btn btn-outline">
                        <span class="btn-icon">üß™</span>
                        Test All Health Endpoints
                    </button>
                </div>
                
                <div class="testing-content">
                    <div class="test-form">
                        <div class="form-group">
                            <label for="test-method">Method:</label>
                            <select id="test-method" class="form-control" disabled>
                                <option value="">Select an endpoint from above</option>
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="PUT">PUT</option>
                                <option value="DELETE">DELETE</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="test-path">Path:</label>
                            <input type="text" id="test-path" class="form-control" placeholder="Click an endpoint card above to select" readonly>
                        </div>
                        
                        <div class="form-group">
                            <button id="test-endpoint-btn" class="btn btn-primary" disabled>
                                <span class="btn-icon">‚ñ∂Ô∏è</span>
                                Test Endpoint
                            </button>
                            <button id="clear-test-form-btn" class="btn btn-secondary" style="margin-left: 10px;" disabled>
                                <span class="btn-icon">üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>
                    </div>
                    
                    <div class="test-results" id="test-results">
                        <!-- Test results will be displayed here -->
                    </div>
                </div>
            </section>

            <!-- Log Viewer Section -->
            <section class="log-viewer-section">
                <div class="section-header">
                    <h2>Log Viewer</h2>
                    <div class="section-actions">
                        <button id="refresh-logs-btn" class="btn btn-outline">
                            <span class="btn-icon">üîÑ</span>
                            Refresh
                        </button>
                        <button id="clear-logs-btn" class="btn btn-outline">
                            <span class="btn-icon">üóëÔ∏è</span>
                            Clear
                        </button>
                    </div>
                </div>
                
                <div class="log-viewer-content">
                    <!-- Log Viewer Content (no tabs needed) -->
                    <div id="historical-logs-content">
                        <!-- Historical Log Controls -->
                        <div class="log-controls">
                            <div class="control-group">
                                <label for="log-file-select">Log File:</label>
                                <select id="log-file-select" class="filter-select">
                                    <option value="">Select log file...</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="historical-log-level">Level:</label>
                                <select id="historical-log-level" class="filter-select">
                                    <option value="">All Levels</option>
                                    <option value="error">Error</option>
                                    <option value="warn">Warning</option>
                                    <option value="info">Info</option>
                                    <option value="http">HTTP</option>
                                    <option value="debug">Debug</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="historical-log-search">Search:</label>
                                <input type="text" id="historical-log-search" class="form-control" placeholder="Search log entries...">
                            </div>
                            
                            <div class="control-group">
                                <label for="log-start-date">Start Date:</label>
                                <input type="datetime-local" id="log-start-date" class="form-control">
                            </div>
                            
                            <div class="control-group">
                                <label for="log-end-date">End Date:</label>
                                <input type="datetime-local" id="log-end-date" class="form-control">
                            </div>
                            
                            <div class="control-group">
                                <button id="search-historical-logs-btn" class="btn btn-primary">
                                    <span class="btn-icon">üîç</span>
                                    Search
                                </button>
                                <button id="download-log-file-btn" class="btn btn-outline">
                                    <span class="btn-icon">üì•</span>
                                    Download
                                </button>
                            </div>
                        </div>
                        
                        <!-- Historical Log Display -->
                        <div class="log-display" id="historical-log-display">
                            <div class="log-file-info" id="log-file-info" style="display: none;">
                                <div class="file-stats">
                                    <span class="stat-item">
                                        <strong>File:</strong> <span id="current-log-file">-</span>
                                    </span>
                                    <span class="stat-item">
                                        <strong>Size:</strong> <span id="log-file-size">-</span>
                                    </span>
                                    <span class="stat-item">
                                        <strong>Entries:</strong> <span id="log-file-entries">-</span>
                                    </span>
                                </div>
                            </div>
                            
                            <div class="log-entries" id="historical-log-entries">
                                <div class="log-placeholder">
                                    Select a log file to view entries
                                </div>
                            </div>
                            
                            <!-- Pagination -->
                            <div class="log-pagination" id="log-pagination" style="display: none;">
                                <button id="prev-page-btn" class="btn btn-outline btn-sm">
                                    <span class="btn-icon">‚óÄÔ∏è</span>
                                    Previous
                                </button>
                                <span class="pagination-info">
                                    Page <span id="current-page">1</span> of <span id="total-pages">1</span>
                                    (<span id="total-entries">0</span> entries)
                                </span>
                                <button id="next-page-btn" class="btn btn-outline btn-sm">
                                    Next
                                    <span class="btn-icon">‚ñ∂Ô∏è</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cache Keys Management Section -->
            <section class="cache-keys-section">
                <div class="section-header">
                    <h2>Cache Keys Management</h2>
                    <div class="section-actions">
                        <button id="refresh-cache-keys-btn" class="btn btn-outline">
                            <span class="btn-icon">üîÑ</span>
                            Refresh
                        </button>
                        <button id="export-cache-keys-btn" class="btn btn-outline">
                            <span class="btn-icon">üì•</span>
                            Export
                        </button>
                    </div>
                </div>
                
                <div class="cache-keys-content">
                    <!-- Cache Keys Controls -->
                    <div class="cache-keys-controls">
                        <div class="control-group">
                            <label for="cache-type-filter">Cache Type:</label>
                            <select id="cache-type-filter" class="filter-select">
                                <option value="">All Cache Types</option>
                                <option value="main">Main Cache</option>
                                <option value="urlTransform">URL Transform</option>
                                <option value="fileResolution">File Resolution</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label for="cache-key-search">Search Pattern:</label>
                            <input type="text" id="cache-key-search" class="form-control" placeholder="Enter search pattern (supports wildcards)">
                        </div>
                        
                        <div class="control-group">
                            <button id="search-cache-keys-btn" class="btn btn-primary">
                                <span class="btn-icon">üîç</span>
                                Search
                            </button>
                            <button id="clear-search-btn" class="btn btn-secondary">
                                <span class="btn-icon">‚úñÔ∏è</span>
                                Clear
                            </button>
                        </div>
                    </div>
                    
                    <!-- Cache Keys Statistics -->
                    <div class="cache-keys-stats">
                        <div class="stat-card">
                            <div class="stat-icon">üóÇÔ∏è</div>
                            <div class="stat-content">
                                <div class="stat-value" id="total-keys-count">-</div>
                                <div class="stat-label">Total Keys</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üíæ</div>
                            <div class="stat-content">
                                <div class="stat-value" id="main-cache-count">-</div>
                                <div class="stat-label">Main Cache</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üîó</div>
                            <div class="stat-content">
                                <div class="stat-value" id="url-transform-count">-</div>
                                <div class="stat-label">URL Transform</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìÅ</div>
                            <div class="stat-content">
                                <div class="stat-value" id="file-resolution-count">-</div>
                                <div class="stat-label">File Resolution</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Cache Keys Display -->
                    <div class="cache-keys-display">
                        <div class="cache-keys-header">
                            <h3>Cache Keys</h3>
                            <div class="display-controls">
                                <button id="copy-visible-keys-btn" class="btn btn-outline btn-sm">
                                    <span class="btn-icon">üìã</span>
                                    Copy Visible
                                </button>
                            </div>
                        </div>
                        <div id="cache-keys-list" class="cache-keys-list">
                            <div class="cache-keys-loading">
                                <div class="loading-spinner-small"></div>
                                <span>Loading cache keys...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Documentation Section -->
            <section class="documentation-section">
                <div class="section-header">
                    <h2>API Documentation</h2>
                    <div class="section-actions">
                        <a href="/dashboard/api/docs/openapi.json" target="_blank" class="btn btn-outline">
                            <span class="btn-icon">üìÑ</span>
                            OpenAPI JSON
                        </a>
                        <a href="/dashboard/api/docs/openapi.yaml" target="_blank" class="btn btn-outline">
                            <span class="btn-icon">üìã</span>
                            OpenAPI YAML
                        </a>
                    </div>
                </div>
                
                <div class="documentation-content">
                    <div class="doc-info">
                        <p>Auto-generated API documentation based on discovered endpoints.</p>
                        <div class="doc-stats">
                            <span class="stat-item">
                                <strong>Last Scan:</strong> 
                                <span id="last-scan-time">-</span>
                            </span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="dashboard-footer">
            <div class="footer-content">
                <span>CDN API Dashboard v1.0.0</span>
                <span id="last-updated">Last updated: -</span>
            </div>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">Loading...</div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="notification-container"></div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Dashboard Settings</h2>
                <button class="modal-close" id="settings-modal-close" aria-label="Close Settings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>API Discovery</h3>
                    <div class="setting-item">
                        <label for="auto-scan-enabled">Auto-scan for new APIs</label>
                        <input type="checkbox" id="auto-scan-enabled" checked>
                    </div>
                    <div class="setting-item">
                        <label for="scan-interval">Scan interval (minutes)</label>
                        <input type="number" id="scan-interval" value="5" min="1" max="60">
                    </div>
                    <div class="setting-item">
                        <button id="manual-scan-btn" class="btn btn-outline">
                            <span class="btn-icon">üîç</span>
                            Run Manual Scan
                        </button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Dashboard Display</h3>
                    <div class="setting-item">
                        <label for="refresh-interval">Auto-refresh interval (seconds)</label>
                        <input type="number" id="refresh-interval" value="30" min="5" max="300">
                    </div>
                    <div class="setting-item">
                        <label for="theme-select">Theme</label>
                        <select id="theme-select">
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                            <option value="auto">Auto</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="compact-view">Compact view</label>
                        <input type="checkbox" id="compact-view">
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Cache Management</h3>
                    <div class="setting-item">
                        <label for="cache-auto-refresh">Auto-refresh cache keys</label>
                        <input type="checkbox" id="cache-auto-refresh" checked>
                    </div>
                    <div class="setting-item">
                        <label for="cache-refresh-interval">Cache refresh interval (minutes)</label>
                        <input type="number" id="cache-refresh-interval" value="2" min="1" max="30">
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Log Viewer</h3>
                    <div class="setting-item">
                        <label for="log-page-size">Entries per page</label>
                        <select id="log-page-size">
                            <option value="50">50</option>
                            <option value="100" selected>100</option>
                            <option value="200">200</option>
                            <option value="500">500</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="log-auto-refresh">Auto-refresh log files</label>
                        <input type="checkbox" id="log-auto-refresh" checked>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Notifications</h3>
                    <div class="setting-item">
                        <label for="show-success-notifications">Show success notifications</label>
                        <input type="checkbox" id="show-success-notifications" checked>
                    </div>
                    <div class="setting-item">
                        <label for="show-error-notifications">Show error notifications</label>
                        <input type="checkbox" id="show-error-notifications" checked>
                    </div>
                    <div class="setting-item">
                        <label for="notification-duration">Notification duration (seconds)</label>
                        <input type="number" id="notification-duration" value="5" min="1" max="30">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="settings-reset-btn" class="btn btn-secondary">Reset to Defaults</button>
                <button id="settings-save-btn" class="btn btn-primary">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="/dashboard/static/js/dashboard.js"></script>
</body>
</html>
